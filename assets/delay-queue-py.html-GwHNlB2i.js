import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{a as t,h as a,o as s}from"./app-dowPD55j.js";const n={};function l(o,e){return s(),t("div",null,e[0]||(e[0]=[a(`<p>In systems that require scheduled or deferred execution of tasks, a delay queue serves as a critical component to hold elements until their specified delay expires. However, python lacks a built-in delay queue implementation. Lets get into the details.</p><h2 id="queue" tabindex="-1"><a class="header-anchor" href="#queue"><span>Queue</span></a></h2><blockquote><p>From <a href="https://en.wikipedia.org/wiki/Queue_(abstract_data_type)" target="_blank" rel="noopener noreferrer">Wikipedia</a>, a queue is a <a href="https://en.wikipedia.org/wiki/Collection_(abstract_data_type)" target="_blank" rel="noopener noreferrer">collection</a> of entities that are maintained in a sequence and can be modified by the addition of entities at one end of the sequence and the removal of entities from the other end of the sequence. By convention, the end of the sequence at which elements are added is called the back, tail, or rear of the queue, and the end at which elements are removed is called the head or front of the queue, analogously to the words used when people line up to wait for goods or services.</p></blockquote><h3 id="queue-in-python" tabindex="-1"><a class="header-anchor" href="#queue-in-python"><span>Queue in Python</span></a></h3><p>Most of the programming languages offer this queue implementation as its core part as its essential in many use cases.</p><p>The <a href="https://docs.python.org/3/library/queue.html#module-queue" target="_blank" rel="noopener noreferrer">queue</a> module in python offers,</p><ol><li>FIFO queue (First In First Out, simply known as Queue)</li><li><a href="https://docs.python.org/3/library/queue.html#queue.LifoQueue" target="_blank" rel="noopener noreferrer">LIFO Queue</a> (Last In First Out)</li><li><a href="https://docs.python.org/3/library/queue.html#queue.PriorityQueue" target="_blank" rel="noopener noreferrer">PriorityQueue</a></li><li>SimpleQueue (also known as Unbounded FIFO Queue)</li></ol><p>Queues can be found in various implementations of frameworks where you need to achieve a thread-safe implementation. i.e., multiple threads can consume from a single queue without causing deadlocks or any race conditions.</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> queue </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Queue </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> FifoQueuefifo_queue = </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">FifoQueue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fifo_queue.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;an item&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fifo_queue.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># returns &quot;an item&quot; from queue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="delayqueue" tabindex="-1"><a class="header-anchor" href="#delayqueue"><span>DelayQueue</span></a></h2><p>DelayQueue is <strong>a specialized Priority Queue that orders elements based on their delay time</strong>. It means only elements whose time has expired can be taken from the queue. DelayQueue head contains the element that has expired/going to expire in the least time.</p><p>DelayQueue’s are useful when it comes to scheduling tasks. Scheduled tasks are bound to wait until the time has come for them to execute. An example of a scheduled task would be reading a transaction table for the previous day at 00:00 and providing some insights to a business.</p><p>The internal implementation of DelayQueue uses a heap, which will sort the elements based on the nearest time of execution. Programming language like Java comes with DelayQueue implementation.</p><h3 id="delayqueue-in-python" tabindex="-1"><a class="header-anchor" href="#delayqueue-in-python"><span>DelayQueue in Python</span></a></h3><p>The queue library in python doesn’t speak about delay queue and the PyPI search shows that there is only one delay queue implementation which also mentions that the project is in the beta stage and has not been updated for almost 6+years. Though the code works, the <code>queue.get</code> will return immediately with an item from the queue or with an exception. It is up to the developer to handle these cases.</p><p>The general intuition of DelayQueue (at least mine) is that the queue.get will wait until the time has come for an item to be popped out of the queue. So, I decided to write the exact <a href="https://github.com/syogaraj/delayedqueue" target="_blank" rel="noopener noreferrer">implementation</a> of the above and published it as a <a href="https://pypi.org/project/delayedqueue/" target="_blank" rel="noopener noreferrer">python package</a>. I believe this will be useful for many who are in search of such implementations in the future.</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Usage for https://github.com/syogaraj/delayedqueue</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> delayedqueue </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> DelayedQueue</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">delay_queue </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> DelayedQueue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">delay_queue.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">put</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;an item&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">delay_queue.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Waits for 30seconds before returning &quot;an item&quot;. If any other item is added via another thread and</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># if the delay precedes of that item, then that item will be returned first.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thank you for reading! See you in the next post.</p>`,18)]))}const u=i(n,[["render",l],["__file","delay-queue-py.html.vue"]]),d=JSON.parse('{"path":"/blog/delay-queue-py.html","title":"DelayQueue in Python","lang":"en-US","frontmatter":{"lang":"en-US","title":"DelayQueue in Python","date":"2022-01-21T00:00:00.000Z","category":["python"],"tag":["queue"],"head":[["meta",{"name":"keywords","content":"delay queue python delayqueue"}],["meta",{"property":"og:url","content":"https://syogaraj.github.io/blog/delay-queue-py.html"}],["meta",{"property":"og:site_name","content":"Yogaraj.S"}],["meta",{"property":"og:title","content":"DelayQueue in Python"}],["meta",{"property":"og:description","content":"In systems that require scheduled or deferred execution of tasks, a delay queue serves as a critical component to hold elements until their specified delay expires. However, pyt..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-02-02T10:20:18.000Z"}],["meta",{"property":"article:tag","content":"queue"}],["meta",{"property":"article:published_time","content":"2022-01-21T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-02-02T10:20:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"DelayQueue in Python\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-01-21T00:00:00.000Z\\",\\"dateModified\\":\\"2025-02-02T10:20:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Yogaraj. S\\",\\"email\\":\\"yogarajsivaprakasam@gmail.com\\"}]}"]],"description":"In systems that require scheduled or deferred execution of tasks, a delay queue serves as a critical component to hold elements until their specified delay expires. However, pyt..."},"headers":[{"level":2,"title":"Queue","slug":"queue","link":"#queue","children":[{"level":3,"title":"Queue in Python","slug":"queue-in-python","link":"#queue-in-python","children":[]}]},{"level":2,"title":"DelayQueue","slug":"delayqueue","link":"#delayqueue","children":[{"level":3,"title":"DelayQueue in Python","slug":"delayqueue-in-python","link":"#delayqueue-in-python","children":[]}]}],"git":{"createdTime":1737822742000,"updatedTime":1738491618000,"contributors":[{"name":"yogaraj.s","username":"yogaraj.s","email":"yogarajsivaprakasam@gmail.com","commits":4,"url":"https://github.com/yogaraj.s"}]},"readingTime":{"minutes":2.04,"words":612},"filePathRelative":"blog/delay-queue-py.md","localizedDate":"January 21, 2022","excerpt":"<p>In systems that require scheduled or deferred execution of tasks, a delay queue serves as a critical component to hold elements until their specified delay expires. However, python lacks a built-in delay queue implementation. Lets get into the details.</p>","autoDesc":true}');export{u as comp,d as data};
